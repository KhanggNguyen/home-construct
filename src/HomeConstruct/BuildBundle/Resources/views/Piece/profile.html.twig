{% extends "@HomeConstructBuild/GrosOeuvre/base-forms-profiles-grosOeuvre.html.twig" %}

{% block content %}
    {% block button_return %}
        {% if refererIsAForm == true or refererLinked == true  %}
            {% set retour = path('home_construct_gros_oeuvre_profile',{'id':grosOeuvre.id}) %}
        {% else %}
            {% set retour = app.request.server.get('HTTP_REFERER') %}
        {% endif %}
        <div class="block_button_back">
            <a id="button_back"
               class="btn btn-xl u-btn-lightblue-v3 g-width-160--md g-font-size-default g-ml-10"
               href="{{ retour }}" data-speed="350">
                <div  class="fas fa-reply"></div>
                Retour
            </a>
        </div>
    {% endblock button_return %}

    {% block sub_content %}
        {% set index = 0 %}
        <div>
            {% if pieces|length >1 %}
                <h3> Liste des {{ pieces|length }} pièces :</h3>
            {% endif %}
        </div>
        <div class="col-lg-9 g-mb-50">
        {% for piece in pieces %}
            {% set index = index +1 %}
            <h3> Pièce n°{{ index }}</h3>
            <!-- Info -->
            <div class="g-brd-around g-brd-gray-light-v4 rounded g-pa-30 g-mb-30">
                <div class="row">
                    <div class="col-12">
                            <span class="d-block">Nom :
                                {% if piece.nom is defined and piece.nom is not null %}
                                    <b>{{ piece.nom }}</b>
                                {% else %}
                                    <b>Non renseigné</b>
                                {% endif %}
                            </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <span class="d-block">Surface :
                            {% if piece.surface is defined and piece.surface is not null %}
                                <b>{{ piece.surface|number_format(2, ',', ' ') }}m²</b>
                            {% else %}
                                <b> Non renseigné </b>
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <span class="d-block">C'est une salle d'eau ?
                            {% if piece.salleDeau is defined and piece.salleDeau is not null %}
                                {% if piece.salleDeau == true %}
                                    <b>Oui</b>
                                {% else %}
                                    <b>Non</b>
                                {% endif %}
                            {% else %}
                                <b> Non renseigné </b>
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <span class="d-block">La cloison est amovible ?
                            {% if piece.cloisonAmovible is defined and piece.cloisonAmovible is not null %}
                                {% if piece.cloisonAmovible == true %}
                                    <b>Oui</b>
                                {% else %}
                                    <b>Non</b>
                                {% endif %}
                            {% else %}
                                <b> Non renseigné </b>
                            {% endif %}
                        </span>
                    </div>
                </div>
            <button id="button_more{{ index }}" onclick="showMoreInfos({{ index }})" class="btn btn-xl u-btn-teal g-width-160--md g-font-size-default">Voir plus<i class="hs-admin-angle-double-down ml-3"></i></button>
            <div id="block_more_infos{{ index }}" style="display: none;">
                <h4> Isolation : </h4>
                {% if piece.isolation is not defined or piece.isolation is null %}
                    <I>Aucune isolation pour le moment</I>
                {% else %}
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Type :
                                <b>{{ piece.isolation.nom }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Prix :
                                <b>{{ piece.isolation.prix|number_format(2, ',', ' ') }} €</b>
                            </span>
                        </div>
                    </div>
                {% endif %}
                <h4> Chauffage : </h4>
                {% if piece.chauffage is not defined or piece.chauffage is null %}
                    <I>Aucun chauffage pour le moment</I>
                {% else %}
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Type :
                                <b>{{ piece.chauffage.type.nom }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Quantité :
                                <b>{{ piece.chauffage.quantite }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Prix total :
                                <b>{{ piece.chauffage.prix |number_format(2, ',', ' ') }} €</b>
                            </span>
                        </div>
                    </div>
                {% endif %}
                {% if grosOeuvre.projet.secondOeuvre is not null %}
                    <div>
                        <a href="{{ path('home_construct_chauffage_list',{'idSecondOeuvre':grosOeuvre.projet.secondOeuvre.id}) }}">
                            Voir tous les chauffages de votre maison
                        </a>
                    </div>
                {% endif %}
                <h4> Ventilation : </h4>
                {% if piece.ventilation is not defined or piece.ventilation is null %}
                    <I>Aucune ventilation pour le moment</I>
                {% else %}
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Type :
                                <b>{{ piece.ventilation.type.nom }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                        <span class="d-block">Quantité :
                            <b>{{ piece.ventilation.quantite }}</b>
                        </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                        <span class="d-block">Prix total :
                            <b>{{ piece.ventilation.prix |number_format(2, ',', ' ') }} €</b>
                        </span>
                        </div>
                    </div>
                {% endif %}
                {% if grosOeuvre.projet.secondOeuvre is not null %}
                    <div>
                        <a href="{{ path('home_construct_ventilation_list',{'idSecondOeuvre':grosOeuvre.projet.secondOeuvre.id}) }}">
                            Voir toutes les ventilations de votre maison
                        </a>
                    </div>
                {% endif %}
                <h4> Climatisation : </h4>
                {% if piece.climatisation is not defined or piece.climatisation is null %}
                    <I>Aucune climatisation pour le moment</I>
                {% else %}
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Type :
                                <b>{{ piece.climatisation.type.nom }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Quantité :
                                <b>{{ piece.climatisation.quantite }}</b>
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="d-block">Prix total :
                                <b>{{ piece.climatisation.prix|number_format(2, ',', ' ') }} €</b>
                            </span>
                        </div>
                    </div>
                    {% endif %}
                    {% if grosOeuvre.projet.secondOeuvre is not null %}
                        <div>
                            <a href="{{ path('home_construct_climatisation_list',{'idSecondOeuvre':grosOeuvre.projet.secondOeuvre.id}) }}">
                                Voir toutes les climatisations de votre maison
                            </a>
                        </div>
                    {% endif %}
                    <h4> Revêtement du sol : </h4>
                    {% if piece.revetementSol is not defined or piece.revetementSol is null %}
                        <I>Aucun revêtement du sol pour le moment</I>
                    {% else %}
                        <div class="row">
                            <div class="col-12">
                                <span class="d-block">Type :
                                    <b>{{ piece.revetementSol.type.nom }}</b>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <span class="d-block">Quantité (en m²) :
                                    <b>{{ piece.revetementSol.quantiteM2 |number_format(2, ',', ' ') }}m²</b>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <span class="d-block">Prix total :
                                    <b>{{ piece.revetementSol.prix|number_format(2, ',', ' ') }} €</b>
                                </span>
                            </div>
                        </div>
                    {% endif %}
                    {% if grosOeuvre.projet.secondOeuvre is not null %}
                        <div>
                            <a href="{{ path('home_construct_revetement_sol_list',{'idSecondOeuvre':grosOeuvre.projet.secondOeuvre.id}) }}">
                                Voir tous les revêtements de sol de votre maison
                            </a>
                        </div>
                    {% endif %}
            </div>
                <div class="text-center">
                    <a id="button_back"
                           class="btn btn-xl u-btn-lightblue-v3 g-width-160--md g-font-size-default g-ml-10"
                           href="{{ path('home_construct_piece_edit',{'idPiece':piece.id}) }}" data-speed="350">
                        Modifier
                        <div  class="fas fa-paint-brush"></div>
                    </a>
                    <a id="button_next"
                       class="btn btn-xl u-btn-red g-width-160--md g-font-size-default g-ml-10"
                       href="{{ path('home_construct_piece_delete',{'idPiece':piece.id}) }}" data-speed="350" onclick="return confirm('Voulez-vous vraiment supprimer la pièce ? Cela supprimera également les chauffages, climatisations etc.. Attention cette action sera irréversible !')">
                        Supprimer
                        <div  class="fas fa-trash"></div>
                    </a>
                </div>

            </div>
            <!-- End Info -->
        {% endfor %}
            <button onclick="topFunction()" id="myBtn" title="Go to top">Haut de page</button>
            <span>
                <a id="button_add"
                   class=" btn btn-xl u-btn-lightblue-v3 g-width-20x--md g-font-size-default g-ml-10 g-mb-10"
                   href="{{ path('home_construct_piece_creation',{'idGrosOeuvre':grosOeuvre.id}) }}" data-speed="350">
                    <div  class="fas fa-plus"></div>
                    Ajouter
                </a>
            </span>
            {% if pieces|length >2%}
                <div>
                    <a id="button_back"
                       class=" btn btn-xl u-btn-lightblue-v3 g-width-160--md g-font-size-default g-ml-10"
                       href="{{ path('home_construct_gros_oeuvre_profile',{'id':grosOeuvre.id}) }}" data-speed="350">
                        <div  class="fas fa-reply"></div>
                        Retour
                    </a>
                </div>
            {% endif %}
        </div>
    {% endblock sub_content %}

{% endblock content %}

{% block javascripts %}
    {{ parent() }}
    <script>
        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function() {scrollFunction()};
        function scrollFunction() {
            if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
                document.getElementById("myBtn").style.display = "block";
            } else {
                document.getElementById("myBtn").style.display = "none";
            }
        }

        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }

    </script>
    <script>
        function showMoreInfos(index){
            var blockMore='block_more_infos'+index;
            var buttonMore='button_more'+index;
            var block=document.getElementById(blockMore);
            var button=document.getElementById(buttonMore);
            if(block.style.display=="block"){
                block.style.display="none";
                button.innerHTML="Voir plus <i class=\"hs-admin-angle-double-down ml-3\"></i>";
            }else{
                block.style.display="block";
                button.innerHTML="Voir moins <i class=\"hs-admin-angle-double-up ml-3\"></i>";
            }
        }
    </script>
{% endblock javascripts %}


